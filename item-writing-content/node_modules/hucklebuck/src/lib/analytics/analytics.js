/* eslint-env browser, jquery */
import $ from 'jquery';
import { bus } from 'partybus';
import useTincan from './tincan_config';
import tryLoginWithQueryString from '../authenticate/auth';
import segment from './destinations/segment';
import googletag from './destinations/google';

const analytics = function (config, testing, sections) {

  var actor = tryLoginWithQueryString(testing.url);

  if (actor === undefined) {
    return true;    //abort
  }

  console.log("ðŸ¤  Actor", '--', actor);
  useTincan(config, testing, sections);
  segment(testing.send, config, actor);
  googletag(testing.send, config, actor);
  bus.emit("actor::found", actor); // for other analytics hooks in the activity
}

export default analytics;
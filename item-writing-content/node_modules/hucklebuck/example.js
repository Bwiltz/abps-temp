/* eslint-env browser, jquery */
import {
  tincanInit,
  tryLoginWithQueryString,
  cheet,
  prefetchSections,
  registerLanguages,
  $
} from './src/hucklebuck';
import './src/playin/snab';
import './src/playin/my_rxjs';

// tryLoginWithQueryString(window.location.href);
tryLoginWithQueryString(
  'https://17515-presscdn-0-77-pagely.netdna-ssl.com/wp-content/uploads/grassblade/6896-course-3/index.html?actor=%7B%22mbox%22%3A%22mailto%3Atjohnson%40scitent.us%22%2C%22name%22%3A%22Tim%20Johnson%22%2C%22objectType%22%3A%22Agent%22%7D&auth=Basic%20MzctMzRiOTNjYWI2MTc0MmUwOmRjOThhYjFjN2U3NDRmZTE4NGRkYzU4N2U%3D&endpoint=https%3A%2F%2Flrs.scitent.us%2FxAPI%2F&registration=&activity_id=http%3A%2F%2Fcareerdevelopment.aaas.org%2Fcourse3'
);

// registerLanguages() takes an array of languages this course supports
// the order should be the order of importance, the first element
// being the default language of the course.
registerLanguages([ 'en', 'fr', 'de', 'be' ]);

// prefetchSections() takes in a configurable manifest of html pages
// that will load in order and then render the first page into the DOM
// at the specified mount point.
prefetchSections([
  { slug: 'anticoag_introduction', title: 'Introducing' },
  {
    slug: 'anticoag_boards_role_in_quality',
    title: "The Board's Role in Quality"
  },
  { slug: 'anticoag_how_form_clot', title: '' },
  { slug: 'anticoag_lab_testing', title: 'Lab Testing' },
  { slug: 'anticoag_lab_testing_cont', title: 'Lab Testing (cont)' },
  { slug: 'anticoag_teg', title: 'TEG' },
  { slug: 'anticoag_review_question_1', title: 'Review Question' },
  { slug: 'anticoag_review_question_2', title: 'Review Question' },
  { slug: 'anticoag_review_question_3', title: 'Review Question' },
  { slug: 'anticoag_review_question_4', title: 'Review Question' },
  {
    slug: 'anticoag_medications_enhancing',
    title: 'Medications Enhancing Anticoagulation & Coagulation'
  },
  { slug: 'anticoag_management', title: 'Management' },
  { slug: 'anticoag_congratulations', title: 'Congratulations' },
  { slug: '404', title: '404' }
]);

const konami_pop = () => console.log('Konami!');

cheet('U U D D L R L R b a', konami_pop);
// cheet('↑ ↑ ↓ ↓ ', run_tranny );

/////////////////////////////
// from activity_config.js //
/////////////////////////////

var config = {
  activity_name: 'Quality Course',
  slug: 'quality_course',
  full_url: 'https://governance.netlify.com/quality_course',
  distpath: '../../quality_course',
  author: 'Scitent http://scitent.com',
  first_section: 'quality_course_introduction',
  theme: 'clean-blog-3.3.7'
};

/////////////////////////
// set initial context //
/////////////////////////

window.context = window.context || {};
window.context.user = {
  email: 'get@fromauth.com',
  name: 'getfromauthquerystring'
};
window.context.course = config.activity_name;
window.context.activity = config.activity_name;
window.context.section = 'init';

var isLocal = (window.location.protocol === 'file:') || (window.location.hostname === 'localhost') || (window.location.hostname.includes('surge.sh'));

var tincan = tincanInit(config, isLocal);

$(document).trigger('activity::ready');

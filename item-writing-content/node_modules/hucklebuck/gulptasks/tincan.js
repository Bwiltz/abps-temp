const gulp = require('gulp');
const htmlreplace = require('gulp-html-replace');

const tincan = function(config) {
  return function() {
    return gulp
      .src('./src/tincan.xml')
      .pipe(
        htmlreplace({
          activity_id: {
            src: config.full_url,
            tpl: '<activity id="%s" type="http://adlnet.gov/expapi/activities/course">'
          },
          activity_name: { src: config.activity_name, tpl: '<name>%s</name>' },
          activity_desc: {
            src: config.activity_name,
            tpl: '<description lang="en-US">%s</description>'
          }
        })
      )
      .pipe(gulp.dest(config.distpath));
  };
};

module.exports = tincan;

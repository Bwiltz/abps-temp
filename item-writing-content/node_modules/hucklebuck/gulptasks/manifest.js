const gulp = require('gulp');
const htmlreplace = require('gulp-html-replace');

const manifest = function(config) {
  return function() {
    return gulp
      .src('./src/manifest.json')
      .pipe(
        htmlreplace({
          author: {
            src: config.author,
            tpl: '<meta name="author" content="%s">'
          },
          content: {
            src: gulp.src(`./src/sections/${config.first_section}.html`),
            tpl: ''
          }
        })
      )
      .pipe(gulp.dest(config.distpath));
  };
};

module.exports = manifest;
